<!doctype html>
<html lang="ru">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<title>view-transition уже на сайте?</title>
		<meta name="description" content="Как добавить view-transition для заголовков">
		<meta name="keywords" content="">

		<link rel="alternate" href="/notes/feed/feed.xml" type="application/atom+xml" title="Notes">
		<link rel="alternate" href="/notes/feed/feed.json" type="application/json" title="Notes">

		<meta name="author" content="asmalcev">

		<meta property="og:title" content="view-transition уже на сайте?">
		<meta property="og:description" content="Как добавить view-transition для заголовков">
		<meta property="og:type" content="website">

		<meta name="generator" content="Eleventy v2.0.1">
		<link rel="stylesheet" href="/notes/bundle/WxESjmk4zH.css">
		<style>:root{--font-family:-apple-system,system-ui,sans-serif;--font-family-monospace:Consolas,Menlo,Monaco,Andale Mono WT,Andale Mono,Lucida Console,Lucida Sans Typewriter,DejaVu Sans Mono,Bitstream Vera Sans Mono,Liberation Mono,Nimbus Mono L,Courier New,Courier,monospace}:root{--color-gray-20:#e0e0e0;--color-gray-50:#C0C0C0;--color-gray-90:#333;--background-color:#fff;--text-color:var(--color-gray-90);--text-color-secondary:var(--color-gray-50);--text-color-link:#082840;--text-color-link-active:#5f2b48;--text-color-link-visited:#17050F;--syntax-tab-size:2}@media (prefers-color-scheme:dark){:root{--color-gray-20:#e0e0e0;--color-gray-50:#C0C0C0;--color-gray-90:#dad8d8;--text-color-link:#1493fb;--text-color-link-active:#6969f7;--text-color-link-visited:#a6a6f8;--background-color:#15202b}}*{box-sizing:border-box}body,html{padding:0;margin:0 auto;font-family:var(--font-family);color:var(--text-color);background-color:var(--background-color)}html{overflow-y:scroll}body{display:flex;flex-direction:column;max-width:40em;min-height:100vh}.visually-hidden{clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}p:last-child{margin-bottom:0}p{line-height:1.5}li{line-height:1.5}a[href]{color:var(--text-color-link)}a[href]:visited{color:var(--text-color-link-visited)}a[href]:active,a[href]:hover{color:var(--text-color-link-active)}main{padding:1rem}main :first-child{margin-top:0}header{border-bottom:1px dashed var(--color-gray-20)}header:after{content:"";display:table;clear:both}.links-nextprev{list-style:none;border-top:1px dashed var(--color-gray-20);padding:1em 0}table{margin:1em 0}table td,table th{padding-right:1em}code,pre{font-family:var(--font-family-monospace)}pre:not([class*=language-]){margin:.5em 0;line-height:1.375;-moz-tab-size:var(--syntax-tab-size);-o-tab-size:var(--syntax-tab-size);tab-size:var(--syntax-tab-size);-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal}code{word-break:break-all}header{display:flex;gap:1em .5em;flex-wrap:wrap;align-items:center;padding:1em}.home-link{font-size:1em;font-weight:700;margin-right:2em}.home-link:link:not(:hover){text-decoration:none}.nav{display:flex;padding:0;margin:0;list-style:none}.nav-item{display:inline-block;margin-right:1em}.nav-item a[href]:not(:hover){text-decoration:none}.nav a[href][aria-current=page]{text-decoration:underline}.postlist{list-style:none;padding:0;padding-left:1.5rem}.postlist-item{display:flex;flex-wrap:wrap;align-items:baseline;counter-increment:start-from 1;margin-bottom:1em}.postlist-item:before{display:inline-block;pointer-events:none;content:"" counter(start-from,decimal-leading-zero) ". ";line-height:100%;text-align:right;margin-left:-1.5rem}.postlist-date,.postlist-item:before{font-size:.8125em;color:var(--color-gray-90)}.postlist-date{word-spacing:-0.5px}.postlist-link{font-size:1.1875em;font-weight:700;flex-basis:calc(100% - 1.5rem);padding-left:.25em;padding-right:.5em;text-underline-position:from-font;text-underline-offset:0;text-decoration-thickness:1px}.postlist-item-active .postlist-link{font-weight:700}.post-tag{display:inline-flex;align-items:center;justify-content:center;text-transform:capitalize;font-style:italic}.postlist-item>.post-tag{align-self:center}.post-metadata{display:inline-flex;flex-wrap:wrap;gap:.5em;list-style:none;padding:0;margin:0}.post-metadata time{margin-right:1em}.header-anchor{text-decoration:none;font-style:normal;font-size:1em;margin-left:.1em}a[href].header-anchor,a[href].header-anchor:visited{color:transparent}a[href].header-anchor:focus,a[href].header-anchor:hover{text-decoration:underline}:hover>a[href].header-anchor,a[href].header-anchor:focus{color:#aaa}h2+.header-anchor{font-size:1.5em}footer{display:flex;justify-content:center;padding:1rem;margin-top:auto;border:1px var(--color-gray-20) solid;border-radius:1rem 1rem 0 0;border-bottom:none}footer p{margin:0;color:var(--text-color-secondary)}@view-transition{navigation:auto}</style>
	</head>
	<body>
		<a href="#skip" class="visually-hidden">Skip to main content</a>

		<header>
			<a href="/notes/" class="home-link">Notes</a>

			<nav>
				<h2 class="visually-hidden">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a href="/notes/">Главная</a></li>
					<li class="nav-item"><a href="/notes/blog/">Архив</a></li>
					<li class="nav-item"><a href="/notes/about/blog/">О блоге</a></li>
				</ul>
			</nav>
		</header>

		<main id="skip">
			


<h1 style="view-transition-name: vtn45a266a8fc6a72d676c2e87ba61ee066">view-transition уже на сайте?</h1>
<ul class="post-metadata">
  <li>
    <time datetime="2025-03-13">13 March 2025</time>
  </li>
</ul>
<h2 id="kak-dobavit" tabindex="-1">Как добавить <a class="header-anchor" href="#kak-dobavit">#</a></h2>
<p>Чтобы включить <code>view-transition</code>, прежде всего нужно указать at-rule на каждой странице, где эта возможность будет использоваться:</p>
<pre class="language-css" tabindex="0"><code class="language-css"><span class="token atrule"><span class="token rule">@view-transition</span></span> <span class="token punctuation">{</span>
  <span class="token property">navigation</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>Затем для получения базовой анимации &quot;перехода&quot; элемента с одной страницы в элемент на другой необходимо указать этим элементам css-свойство <code>view-transition-name</code> с одинаковым значением, например, если это заголовок, то:</p>
<pre class="language-css" tabindex="0"><code class="language-css"><span class="token selector">h1</span> <span class="token punctuation">{</span>
  <span class="token property">view-transition-name</span><span class="token punctuation">:</span> title<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>Важное условие заключается в том, что значения <code>view-transition-name</code> должны быть уникальными на каждой странице. В случае с блогом, где в ленте записей может быть несколько ссылок на каждый отдельный пост появляется задача сгенировать уникальные значения для каждого поста.</p>
<p>Для 11ty можно добавить фильтр Nunjucks, который будет генерировать хэш на основе переданной в него строки — именно это и будет уникальный идентифкатор поста:</p>
<pre class="language-js" tabindex="0"><code class="language-js">eleventyConfig<span class="token punctuation">.</span><span class="token function">addFilter</span><span class="token punctuation">(</span><span class="token string">"generateHashId"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">vtn</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">"md5"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">"hex"</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><code>vtn</code> в начале нужно, т.к. хэш необязательно сгенерируется с первой буквой, а согласно правилам названий <code>view-transition-name</code>, имя должно начинаться именно с буквы (аналогично названиям переменных в js). А <code>vtn</code> я взял по первым буквам css-свойства</p>
<p>Использовать этот фильтр можно так:</p>
<pre class="language-html" tabindex="0"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span>
  <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token selector">view-transition-name:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span> title | generateHashId <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">"</span></span></span>
<span class="token punctuation">></span></span>
  view-transition уже на сайте?
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></code></pre>
<h2 id="podderzhka-v-brauzerah" tabindex="-1">Поддержка в браузерах <a class="header-anchor" href="#podderzhka-v-brauzerah">#</a></h2>
<p><baseline-status featureId="view-transitions"></baseline-status></p>


		</main>

		<footer>
			<p>© asmalcev 2025</p>
		</footer>

		<script src="https://cdn.jsdelivr.net/npm/baseline-status@1/baseline-status.min.js" type="module" defer=""></script>
		<!-- This page `/notes/blog/view-transition/` was built on 2025-03-13T00:16:26.350Z -->
	</body>
</html>
